# Warren Service

## Routes

### **Log in User**:

> Logs in the user and returns its auth token used to validate all other requests besides login and registration.

**Endpoint:** `POST warren_service/login`

**Requires Auth:** No.

**Query:** None.

**Params:** None.

**Body:**

User id and password to log in:

``
{
  _id: string,
  password: string
}
``

**Success return:**

Authentication token generated by login:

``
{
  token: string
}
``

---

### **Register User**:

> Registers a new user, adding it to the database and allowing it to log in. Returns the registered user's id.

**Endpoint:** `POST warren_service/register`

**Requires Auth:** No.

**Query:** None.

**Params:** None.

**Body:**

User id and password to register:

``
{
  _id: string,
  password: string
}
``

**Success return:**

Registered user id:

``
{
  _id: string
}
``

---

### **Change User Password**:

> Updates a registered user's password and returns the modified user id.

**Endpoint:** `PUT warren_service/:_id/password`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id from which to get the data.

``
_id: string
``

**Body:** 

New password with which to update:

``
password: string
``

**Success return:**

User id that had its password changed:

``
_id: string
``

---

### **Delete User**:

> Deletes a registered user and returns nothing.

**Endpoint:** `DELETE warren_service/:_id`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id to delete.

``
_id: string
``

**Body:** None.

**Success return:** None.

---

### **Recover User**:

> Recovers and returns all of a user's data.

**Endpoint:** `GET warren_service/:_id`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id from which to get the data.

``
_id: string
``

**Body:** None.

**Success return:**

User data (no password):

```
{
  _id: string
  categories[]: 
    name: string
    iconIndex: number
    colour: string
    transactions[]: 
      name: string
      date: string
      amount: number
      sourceOrDestination: string
      transactionType: 'deposit' | 'withdraw'
      paymentType: string
      walletId: number
      description?: string
    description?: string
  wallets[]: 
    name: string
    iconIndex: number
    colour: string
}
```

---

### **Update User**:

> Updates a registered user's category, transaction and wallet data.

**Endpoint:** `PUT warren_service/:_id`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id to update.

``
_id: string
``

**Body:**

Body with which to update the user (_id and password not included):

```
{
  categories[]: 
    name: string
    iconIndex: number
    colour: string
    transactions[]: 
      name: string
      date: string
      amount: number
      sourceOrDestination: string
      transactionType: 'deposit' | 'withdraw'
      paymentType: string
      walletId: number
      description?: string
    description?: string
  wallets[]: 
    name: string
    iconIndex: number
    colour: string
}
```

**Success return:**

Resulting user data after update (no password):

```
{
  _id: string
  categories[]: 
    name: string
    iconIndex: number
    colour: string
    transactions[]: 
      name: string
      date: string
      amount: number
      sourceOrDestination: string
      transactionType: 'deposit' | 'withdraw'
      paymentType: string
      walletId: number
      description?: string
    description?: string
  wallets[]: 
    name: string
    iconIndex: number
    colour: string
}
```

---

### **Get User Balances in Period**:

> Recovers a registered user's balances within a specified interval.

**Endpoint:** `GET warren_service/:_id/balances`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id from which to recover data.

``
_id: string
``

**Body:**

Starting month and ending month of period from which to get the balances. Month string format is 'YYYY-MM'.

```
  startingMonth: string
  endingMonth: string
```

**Success return:**

An array of all balances with their respective months, ordered from oldest to newest:

Each index of the array has the following format:
```
  date: string
  balance: number
```

---

### **Get User Transfer Amounts in Period**:

> Recovers a registered user's transfer (deposits & withdraws) amounts within a specified interval.

**Endpoint:** `GET warren_service/:_id/transfers`

**Requires Auth:** Yes.

**Query:** None.

**Params:** 

User id from which to recover data.

``
_id: string
``

**Body:**

Starting month and ending month of period from which to get the transfer amounts. Month string format is 'YYYY-MM'.

```
  startingMonth: string
  endingMonth: string
```

**Success return:**

The total amount of money that was deposited and withdrawn from the user's account within the provided interval.

```
  deposits: number
  withdraws: number
```
